#!/usr/bin/env python3
# -*- encoding:utf-8 -*-

"""
@license:   (C) Copyright 2013-2017, Node Supply Chain Manager Corporation Limited.
@software:  PyCharm
@file:      PythonTools_Process.py
@author:    ziv
@time:      2019/6/5
@version:   v1.0.0
@desc:      脚本功能描述

{'_id': '56834dc53977bd05ead567d2', 'play_count': 658178.4333333333}
{'_id': ObjectId('55fbc2663977bd3aafd76ff7'), 'rating': '8.1', 'small_poster': 'http://i.gtimg.cn/qqlive/img/jpgcache/files/qqvideo/0/01dicqqlumabs7t.jpg', 'subtitle': [{'title': '类型', 'value': ['家庭', '剧情'], 'action': ''}, {'title': '主演', 'action': 'actors', 'value': ['杨童舒', '郭东文', '由力', '艾义热提·玉买尔', '顾峰']}], 'pid': '01dicqqlumabs7t', 'site': 'open.qq.com', 'episodes': [{'title': '第1集', 'episode': '1', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/p00160zyrsi_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'p00160zyrsi', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/p00160zyrsi.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_01'}, {'title': '第2集', 'episode': '2', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/z0016kpjn68_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'z0016kpjn68', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/z0016kpjn68.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_02'}, {'title': '第3集', 'episode': '3', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/u0017u3o193_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'u0017u3o193', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/u0017u3o193.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_03'}, {'title': '第4集', 'episode': '4', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/q0016ncs5mk_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'q0016ncs5mk', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/q0016ncs5mk.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_04'}, {'title': '第5集', 'episode': '5', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/z0017cs7xnt_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'z0017cs7xnt', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/z0017cs7xnt.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_05'}, {'title': '第6集', 'episode': '6', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/l0016vkrjwd_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'l0016vkrjwd', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/l0016vkrjwd.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_06'}, {'title': '第7集', 'episode': '7', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/w0016slz2zk_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'w0016slz2zk', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/w0016slz2zk.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_07'}, {'title': '第8集', 'episode': '8', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/v0017g4opw5_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'v0017g4opw5', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/v0017g4opw5.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_08'}, {'title': '第9集', 'episode': '9', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/x0017zwh250_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'x0017zwh250', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/x0017zwh250.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_09'}, {'title': '第10集', 'episode': '10', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/w0017qzl18c_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'w0017qzl18c', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/w0017qzl18c.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_10'}, {'title': '第11集', 'episode': '11', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/g0016zza00t_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'g0016zza00t', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/g0016zza00t.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_11'}, {'title': '第12集', 'episode': '12', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/y0017tev70l_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'y0017tev70l', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/y0017tev70l.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_12'}, {'title': '第13集', 'episode': '13', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/s00176j22an_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 's00176j22an', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/s00176j22an.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_13'}, {'title': '第14集', 'episode': '14', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/h0017j7ljhb_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'h0017j7ljhb', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/h0017j7ljhb.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_14'}, {'title': '第15集', 'episode': '15', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/d0017622i37_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'd0017622i37', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/d0017622i37.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_15'}, {'title': '第16集', 'episode': '16', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/k00174bssxf_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'k00174bssxf', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/k00174bssxf.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_16'}, {'title': '第17集', 'episode': '17', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/s00174goepx_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 's00174goepx', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/s00174goepx.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_17'}, {'title': '第18集', 'episode': '18', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/r0017driwvh_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'r0017driwvh', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/r0017driwvh.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_18'}, {'title': '第19集', 'episode': '19', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/b00177jue3e_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'b00177jue3e', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/b00177jue3e.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_19'}, {'title': '第20集', 'episode': '20', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/p0017maqc00_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'p0017maqc00', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/p0017maqc00.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_20'}, {'title': '第21集', 'episode': '21', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/s0017800s5e_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 's0017800s5e', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/s0017800s5e.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_21'}, {'title': '第22集', 'episode': '22', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/a0017qsyhsr_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'a0017qsyhsr', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/a0017qsyhsr.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_22'}, {'title': '第23集', 'episode': '23', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/g0016h7coh2_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'g0016h7coh2', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/g0016h7coh2.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_23'}, {'title': '第24集', 'episode': '24', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/r00163lpfqd_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'r00163lpfqd', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/r00163lpfqd.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_24'}, {'title': '第25集', 'episode': '25', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/q0016hy63at_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'q0016hy63at', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/q0016hy63at.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_25'}, {'title': '第26集', 'episode': '26', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/y0017el4avy_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'y0017el4avy', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/y0017el4avy.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_26'}, {'title': '第27集', 'episode': '27', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/x00179wt7y9_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'x00179wt7y9', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/x00179wt7y9.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_27'}, {'title': '第28集', 'episode': '28', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/s0017h48v2u_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2732', 'qq_vid': 's0017h48v2u', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/s0017h48v2u.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_28'}, {'title': '第29集', 'episode': '29', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/r00171xxk2u_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'r00171xxk2u', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/r00171xxk2u.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_29'}, {'title': '第30集', 'episode': '30', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/a00172yejln_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'a00172yejln', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/a00172yejln.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_30'}], 'intro': '这部电视连续剧是以新一轮援疆为大背景和出发点，通过小人物反映大背景，描绘壮丽时代，叙述百姓生活，塑造平民英雄，讴歌民族团结。全剧通过一批援疆干部可歌可泣的故事，展现他们援疆3年间的喜怒哀乐，以及大爱无疆的精神风貌，是一部难得的援疆题材主旋律影视作品。', 'year': '2013', 'area': ['内地'], 'big_poster': 'http://i.gtimg.cn/qqlive/img/jpgcache/files/qqvideo/0/01dicqqlumabs7t.jpg', 'column_id': '0', 'actors': ['杨童舒', '郭东文', '由力', '艾义热提·玉买尔', '顾峰'], 'season': '1', 'type': ['家庭', '剧情'], 'channel': [], 'status': 2147483135, 'infotext': '全30集', 'cur_episode': '30', 'definition': '2', 'poster': 'http://i.gtimg.cn/qqlive/img/jpgcache/files/qqvideo/0/01dicqqlumabs7t.jpg', 'vip_type': [], 'updated_at': 1480410570845, 'director': ['刘建华', '罗浩'], 'src': 'qq_api', 'category_id': '1', 'language': '国语', 'cid': '01dicqqlumabs7t', 'created_at': 1442562662465, 'title': '同心兄弟', 'presenter': [], 'sources_length': '30', 'merged_ids': ['53c7954ce4b07e19a35b6e2f'], 'max_episode': '30', 'lastmodified': 1480376452774.0, 'flush_required': 0, 'episode_updated_at': 1472673642899, 'one_day_play_count_naturally': 11, 'trailer_episodes': [], 'douban_tag': ['剧情', '国产电视剧', '2013'], 'modified_by': 'backend_manage', 'publish_time': '', 'is_trailer': '0', 'qq_video_tag': ['家庭', '剧情', '主旋律'], 'trytime': '0', 'episode_updated': '全30集', 'is_fully_vip': '0', 'verbose_infotext': '全30集', 'cur_free_episode': '30', 'action': 'del'}
"""

import csv
import pymongo
import time
from bson.objectid import ObjectId

show_db_names_in_client = 0
show_tab_names_in_db = 0

mongo_client = pymongo.MongoClient("mongo_db://192.168.6.125:27017")
if show_db_names_in_client:
    db_list = mongo_client.list_database_names()
    # ['History', 'Voice', 'local', 'mediatube', 'mediatube_ads',
    # 'newhao123', 'qqmedia', 'statics', 'test', 'user', 'webox_layout']
    print(db_list)

statics_db = mongo_client["statics"]
if show_tab_names_in_db:
    tab_list = statics_db.list_collection_names()
    # 'statics', 'data_out', 'tmp.mr.statics_1', 'programs', 'total']
    print(tab_list)

col_data_out = statics_db["data_out"]
# print(col_data_out.count())
col_programs = statics_db["programs"]

# print(col_data_out.find_one())
# program = {'_id': ObjectId('55fbc2663977bd3aafd76ff7'), 'rating': '8.1', 'small_poster': 'http://i.gtimg.cn/qqlive/img/jpgcache/files/qqvideo/0/01dicqqlumabs7t.jpg', 'subtitle': [{'title': '类型', 'value': ['家庭', '剧情'], 'action': ''}, {'title': '主演', 'action': 'actors', 'value': ['杨童舒', '郭东文', '由力', '艾义热提·玉买尔', '顾峰']}], 'pid': '01dicqqlumabs7t', 'site': 'open.qq.com', 'episodes': [{'title': '第1集', 'episode': '1', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/p00160zyrsi_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'p00160zyrsi', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/p00160zyrsi.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_01'}, {'title': '第2集', 'episode': '2', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/z0016kpjn68_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'z0016kpjn68', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/z0016kpjn68.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_02'}, {'title': '第3集', 'episode': '3', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/u0017u3o193_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'u0017u3o193', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/u0017u3o193.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_03'}, {'title': '第4集', 'episode': '4', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/q0016ncs5mk_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'q0016ncs5mk', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/q0016ncs5mk.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_04'}, {'title': '第5集', 'episode': '5', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/z0017cs7xnt_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'z0017cs7xnt', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/z0017cs7xnt.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_05'}, {'title': '第6集', 'episode': '6', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/l0016vkrjwd_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'l0016vkrjwd', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/l0016vkrjwd.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_06'}, {'title': '第7集', 'episode': '7', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/w0016slz2zk_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'w0016slz2zk', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/w0016slz2zk.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_07'}, {'title': '第8集', 'episode': '8', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/v0017g4opw5_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'v0017g4opw5', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/v0017g4opw5.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_08'}, {'title': '第9集', 'episode': '9', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/x0017zwh250_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'x0017zwh250', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/x0017zwh250.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_09'}, {'title': '第10集', 'episode': '10', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/w0017qzl18c_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'w0017qzl18c', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/w0017qzl18c.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_10'}, {'title': '第11集', 'episode': '11', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/g0016zza00t_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'g0016zza00t', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/g0016zza00t.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_11'}, {'title': '第12集', 'episode': '12', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/y0017tev70l_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'y0017tev70l', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/y0017tev70l.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_12'}, {'title': '第13集', 'episode': '13', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/s00176j22an_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 's00176j22an', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/s00176j22an.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_13'}, {'title': '第14集', 'episode': '14', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/h0017j7ljhb_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'h0017j7ljhb', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/h0017j7ljhb.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_14'}, {'title': '第15集', 'episode': '15', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/d0017622i37_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'd0017622i37', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/d0017622i37.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_15'}, {'title': '第16集', 'episode': '16', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/k00174bssxf_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'k00174bssxf', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/k00174bssxf.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_16'}, {'title': '第17集', 'episode': '17', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/s00174goepx_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 's00174goepx', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/s00174goepx.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_17'}, {'title': '第18集', 'episode': '18', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/r0017driwvh_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'r0017driwvh', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/r0017driwvh.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_18'}, {'title': '第19集', 'episode': '19', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/b00177jue3e_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'b00177jue3e', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/b00177jue3e.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_19'}, {'title': '第20集', 'episode': '20', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/p0017maqc00_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'p0017maqc00', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/p0017maqc00.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_20'}, {'title': '第21集', 'episode': '21', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/s0017800s5e_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 's0017800s5e', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/s0017800s5e.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_21'}, {'title': '第22集', 'episode': '22', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/a0017qsyhsr_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'a0017qsyhsr', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/a0017qsyhsr.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_22'}, {'title': '第23集', 'episode': '23', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/g0016h7coh2_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'g0016h7coh2', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/g0016h7coh2.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_23'}, {'title': '第24集', 'episode': '24', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/r00163lpfqd_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'r00163lpfqd', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/r00163lpfqd.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_24'}, {'title': '第25集', 'episode': '25', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/q0016hy63at_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'q0016hy63at', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/q0016hy63at.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_25'}, {'title': '第26集', 'episode': '26', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/y0017el4avy_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'y0017el4avy', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/y0017el4avy.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_26'}, {'title': '第27集', 'episode': '27', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/x00179wt7y9_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'x00179wt7y9', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/x00179wt7y9.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_27'}, {'title': '第28集', 'episode': '28', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/s0017h48v2u_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2732', 'qq_vid': 's0017h48v2u', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/s0017h48v2u.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_28'}, {'title': '第29集', 'episode': '29', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/r00171xxk2u_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2733', 'qq_vid': 'r00171xxk2u', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/r00171xxk2u.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_29'}, {'title': '第30集', 'episode': '30', 'drm': '0', 'poster': 'http://shp.qpic.cn/qqvideo_ori/0/a00172yejln_228_128/0', 'sources': [{'site': 'open.qq.com', 'duration': '2734', 'qq_vid': 'a00172yejln', 'source': 'http://v.qq.com/cover/0/01dicqqlumabs7t/a00172yejln.html', 'episode_parse_method': '200', 'definitions': ['2', '1'], 'qq_cid': '01dicqqlumabs7t', 'qq_tailer': '0', 'qq_header': '0'}], 'intro': '同心兄弟_30'}], 'intro': '这部电视连续剧是以新一轮援疆为大背景和出发点，通过小人物反映大背景，描绘壮丽时代，叙述百姓生活，塑造平民英雄，讴歌民族团结。全剧通过一批援疆干部可歌可泣的故事，展现他们援疆3年间的喜怒哀乐，以及大爱无疆的精神风貌，是一部难得的援疆题材主旋律影视作品。', 'year': '2013', 'area': ['内地'], 'big_poster': 'http://i.gtimg.cn/qqlive/img/jpgcache/files/qqvideo/0/01dicqqlumabs7t.jpg', 'column_id': '0', 'actors': ['杨童舒', '郭东文', '由力', '艾义热提·玉买尔', '顾峰'], 'season': '1', 'type': ['家庭', '剧情'], 'channel': [], 'status': 2147483135, 'infotext': '全30集', 'cur_episode': '30', 'definition': '2', 'poster': 'http://i.gtimg.cn/qqlive/img/jpgcache/files/qqvideo/0/01dicqqlumabs7t.jpg', 'vip_type': [], 'updated_at': 1480410570845, 'director': ['刘建华', '罗浩'], 'src': 'qq_api', 'category_id': '1', 'language': '国语', 'cid': '01dicqqlumabs7t', 'created_at': 1442562662465, 'title': '同心兄弟', 'presenter': [], 'sources_length': '30', 'merged_ids': ['53c7954ce4b07e19a35b6e2f'], 'max_episode': '30', 'lastmodified': 1480376452774.0, 'flush_required': 0, 'episode_updated_at': 1472673642899, 'one_day_play_count_naturally': 11, 'trailer_episodes': [], 'douban_tag': ['剧情', '国产电视剧', '2013'], 'modified_by': 'backend_manage', 'publish_time': '', 'is_trailer': '0', 'qq_video_tag': ['家庭', '剧情', '主旋律'], 'trytime': '0', 'episode_updated': '全30集', 'is_fully_vip': '0', 'verbose_infotext': '全30集', 'cur_free_episode': '30', 'action': 'del'}
# print(program["category_id"])
# print(col_programs.find_one())


class Controller(object):
    def __init__(self):
        # 查询失败次数: 对应_id不存在节目对应
        self.count_failed = 0
        self.count_index = 0
        # 所有影片数据
        self.alldata = [("_id", "title")]
        # 电影
        self.movie = [("_id", "title")]
        # 电视剧
        self.program = [("_id", "title")]
        # 其他
        self.others = [("_id", "title", "category_id")]

    def analyzeData(self):
        # id信息
        list_id = col_data_out.find()
        total_count = col_data_out.count()
        for item in list_id:
            try:
                result = col_programs.find_one({"_id": ObjectId(item["_id"])})
                self.count_index = self.count_index + 1
                print("\"_id\": {}, \"title\": {} , \"category_id\": {} \t process:{}/{}"
                      .format(item["_id"], result["title"], result["category_id"], self.count_index, total_count))

                if int(result["category_id"]) == 1:
                    self.movie.append((item["_id"], result["title"]))
                elif int(result["category_id"]) == 2:
                    self.program.append((item["_id"], result["title"]))
                else:
                    self.others.append((item["_id"], result["title"], result["category_id"]))

                self.alldata.append((item["_id"], result["title"]))
            except:
                self.count_failed = self.count_failed + 1

    def saveDataToCSV(self):
        csvfile = open("movie.csv", "w")
        writer = csv.writer(csvfile)
        writer.writerows(self.movie)
        csvfile.close()
        csvfile = open("program.csv", "w")
        writer = csv.writer(csvfile)
        writer.writerows(self.program)
        csvfile.close()
        csvfile = open("others.csv", "w")
        writer = csv.writer(csvfile)
        writer.writerows(self.others)
        csvfile.close()
        csvfile = open("all.csv", "w")
        writer = csv.writer(csvfile)
        writer.writerows(self.alldata)
        csvfile.close()


if __name__ == "__main__":
    controller = Controller()
    controller.analyzeData()
    controller.saveDataToCSV()
    print("empty count:", controller.count_failed)
